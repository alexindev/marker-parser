# Парсер Маркетплейса

Веб приложение для парсинга товаров с маркетплейса с фильтрацией, сортировкой и пагинацией.

## Возможности

- Многопоточный парсинг (10 страниц по 100 товаров)
- Фильтрация и сортировка товаров
- Пагинация результатов с метаданными
- Обработка дубликатов и транзакционная безопасность

## API Endpoints

### Поисковые запросы
- `GET /api/search/` - получение списка поисковых запросов
- `POST /api/search/` - создание нового поискового запроса
- `GET /api/search/{id}/` - получение деталей поискового запроса
- `DELETE /api/search/{id}/` - удаление поискового запроса
- `POST /api/search/validate_query/` - валидация текста запроса
- `GET /api/search/history/` - получение истории поисковых запросов

### Результаты
- `GET /api/products/result/?id={id}` - результаты для конкретного запроса с сортировкой

### Параметры сортировки (значения: `asc`/`desc`)
- `name_sort` - сортировка по названию товара
- `brand_sort` - сортировка по бренду
- `supplier_sort` - сортировка по поставщику
- `supplier_rating_sort` - сортировка по рейтингу поставщика
- `review_rating_sort` - сортировка по рейтингу отзывов
- `feedbacks_sort` - сортировка по количеству отзывов
- `price_sort` - сортировка по цене

### Параметры пагинации
- `page` - номер страницы (по умолчанию: 1)
- `page_size` - количество элементов на странице (по умолчанию: 10, максимум: 100)

## Установка и запуск

### Клонировать проект

```bash
git clone https://github.com/alexindev/marker-parser.git
```

### Запуск в докер
```bash
docker-compose up
```

## Примеры запросов
```bash
# Получение списка всех поисковых запросов
curl -X GET http://localhost/api/search/

# Валидация запроса перед запуском парсинга
curl -X POST http://localhost/api/search/validate_query/ \
  -H "Content-Type: application/json" \
  -d '{"query": "джинсы мужские"}'

# Создание поискового запроса
curl -X POST http://localhost/api/search/ \
  -H "Content-Type: application/json" \
  -d '{"query_text": "джинсы мужские"}'

# Получение результатов с сортировкой
curl -X GET "http://localhost/api/products/result/?id=1&price_sort=asc"
```

### Запуск тестов локально

```bash
# Запуск всех тестов
uv run manage.py test
```
